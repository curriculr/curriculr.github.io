---
layout: docs
title: Installation
side_menu_docs:
  - title: Home
    url: docs/index.html
  - title: Installation
    url: docs/installation.html
    active: true
  - title: Configuration
    url: docs/configuration.html
side_menu_tutorials:
  - title: Introduction
    url: tutorials/introduction.html
  #- title: For administrators
  #  url: tutorials/administrator.html
  - title: For instructors
    url: tutorials/instructor.html
  - title: For students
    url: tutorials/student.html
---

## Pre-requisites
Before Curriculr can be deployed, the following must be done:

- Either PostgreSQL or MySQL server is installed and is ready to accept connections. Change the `Gemfile` to include the gem of the database you installed and comment out the one you did not.

{% highlight ruby %}
...

# Either postgresql  
gem 'pg'
# or mysql
#gem 'mysql2'

...
{% endhighlight %}

- Redis server is installed and ready to accept connections.

## Specifying Application Secrets
Before you can deploy Curriculr, certain pieces of information (we call secrets) have to be provided. These secrets defer from one environment to another and from one application instance to another and are stored in a file called `config/secrets.yml`. To help with the creation of this file, Curriculr comes with a `rake` task

{% highlight sh %}
rake curriculr:secrets:generate
{% endhighlight %}

This will create the `secrets.yml` under the `config/` folder, if it does not exit already. Open this file and make the necessary changes. 

Below is a description of what theses secrets mean.

### Super user
{% highlight yaml %}
site:
  su_name: Super User
  su_email: admin@example.com
  su_password: a_secret
{% endhighlight %}

These settings identify the name, email, and password of the super user of the application. This user is a special *root-like* user with an `id = 1' and has full control over everything in the application.

### Database settings
{% highlight yaml %}
database:
  adapter: postgresql # mysql or postgresql
  name: curriculr
  username: DB_USERNAME
  password: a_secret
  socket: /tmp/mysql.sock
{% endhighlight %}

This is where the database is configured. To start, specify the `adapter` which tells whether the database being used is PostgreSQL or MySQL. Both are supported by Curriculr. Following that, you set the name of the database schema, db username and password needed to connect to the database server, and the socket needed for such a connection (in the case of MySQL database server).

### File uploads
{% highlight yaml %}
storage:
  type: file
  asset_host: 'http://localhost:3000'
{% endhighlight %}

This is how and where we specify how updated course materials are stored. The `type` setting can take one two values: `file` or `fog`. `file` type indicates that uploaded files are stored in the same machine running the application. `fog` type allows Curriculr to upload files into other cloud-based file services such as [Amazon S3](http://aws.amazon.com/s3/), [Rackspace Cloud Files](http://www.rackspace.com/cloud/files/) or [Google Storage](https://cloud.google.com/storage/).

If type is `fog`, the following settings will have to be provided as well.

{% highlight yaml %}
fog:
  directory: AWS_DIRECTORY
  public: true
  AWS:
    aws_access_key_id: xxx                 # required
    aws_secret_access_key: yyy             # required
    region: eu-west-1                      # optional
    host: s3.example.com                   # optional
    endpoint: https://s3.example.com:8080  # optional
{% endhighlight %}

for Amazon S3,

{% highlight yaml %}
fog:
  directory: RACKSPACE_DIRECTORY
  public: true
  Rackspace:
    rackspace_username: xxx
    rackspace_api_key: yyy
    rackspace_region: ord                # optional, defaults to dfw
{% endhighlight %}

for Rackspace Cloud Files, and

{% highlight yaml %}
fog:
  directory: GOOGLE_DIRECTORY
  public: true
  Google:
    google_storage_access_key_id: xxx
    google_storage_secret_access_key: yyy
{% endhighlight %}

for Google Storage.

### Facebook and Google authentication

{% highlight yaml %}
auth: 
  facebook:
    id: AUTH_FACEBOOK_ID
    secret: AUTH_FACEBOOK_SECRET
  google_oauth2:
    id: AUTH_GOOGLE_ID
    secret: AUTH_GOOGLE_SECRET
{% endhighlight %}

Using the above settings, Curriculr allows users to bypass the registration step and sign in using their existing `facebook` and `google` accounts. 

### Application secret key
{% highlight yaml %}
secret_key_base: e0fa05385ec9e9a58b818ec08e...
{% endhighlight %}

This is required by Rails and typically used to generate a secret for cookie sessions. It can be generated by running:

{% highlight sh %}
rake secret
{% endhighlight %}

These keys differ from one enrnironment to another.

### Mailer settings
{% highlight yaml %}
mailer:
  host: MAILER_HOST
  port: 587
  domain: MAILER_DOMAIN
  username: MAILER_USERNAME
  password: MAILER_PASSWORD
{% endhighlight %}

## Deploying the Application
Now that the application secrets are provided, you can follow the steps below to deploy Curriculr into a `development` environment.

1: Run bundler

{% highlight sh %}
bundle install
{% endhighlight %}

2: Create the database and run migrations

{% highlight sh %}
rake curriculr:db:migrate
{% endhighlight %}

3: Load the seed data

{% highlight sh %}
rake db:seed
{% endhighlight %}

This will create the default account(tenant) and the first user based on the information from the secrets file.

4: Reset Redis configurations and translations

{% highlight sh %}
rake curriculr:redis:reset
{% endhighlight %}

**Please note that** steps 2, 3, and 4 can be combined together by running

{% highlight sh %}
rake curriculr:bootstrap
{% endhighlight %}

5: Finally, run Rails server to start the application in development

{% highlight sh %}
rails server
{% endhighlight %}

Now you can visit `http://localhost:3000` which looks like:

![Curriculr front page]({{ site.baseurl }}/images/install-fig01.png)
